Σκοπός του Προγράμματος:
===================================
Να βοηθήσει τον χρήστη να ελέγξει ΗΔΗ ΚΑΤΑΧΩΡΗΜΕΝΕΣ ΚΡΑΤΗΣΕΙΣ Genero, με ένα αρχείο Ελέγχου από την CYPLON

Διακρίνουμε δύο κύριες λειτουργίες:
-----------------------------------
1. Κάνει το mapping ανάμεσα στα λεκτικά Ξενοδοχείων και Δωματίων όπως δίνονται σε excel file κρατήσεων από την Cyplon
και τους κωδικούς του TC όπως τους τηρεί στη ΒΔ. (servi.se_htl, tcroom.tc_rc3)
Διαβάζει κρατήσεις από excel (για έλεγχο) και παράγει ένα παρόμοιο αποτέλεσμα όπου έχει
εμπλουτίσει τα δεδομένα με τους κωδικούς HotelCode και RoomCode

2. Διαβάζει από ascii file (.unl) κρατήσεις καταχωρημένες στην DB και προσπαθεί να αναλύσει τις διαφορές
μεταξύ αυτών και του excel ελέγχου.



Τι απαιτεί:
------------------------------------
Ascii file Ονοματα Ξενοδοχείων
Ascii file Ονοματα Δωματίων
Ascii file Καταχωρημένων κρατήσεων
Excel file ελέγχου με κρατήσεις όπως τις δίνει ο Tour Operator



Ascii file Ονοματα Ξενοδοχείων &
Ascii file Ονοματα Δωματίων:
------------------------------------
Τα προμηθεύουμε εμείς με SQL scripts:
select tm_htl htl
from tcmast where tm_seas="SO16" and tm_oper=6
group by 1 into temp tempaki1;

select r.tr_htl htl, r.tr_rc3 rc3, r.tr_des des
from tempaki1 t, tcroom r
where r.tr_htl = t.htl
into temp tempaki2;

unload to "SO16.6.rooms.unl"
select * from tempaki2
order by 1,2

unload to "SO16.6.hotels.unl"
select se.se_htl, se.se_des
from tempaki1 t1, servi se
where se.se_htl = t1.htl
order by 1;



Excel file ελέγχου με κρατήσεις όπως τις δίνει ο Tour Operator
------------------------------------
Input Excel file: στο 1ο sheet του οποίου να υπάρχουν στην πρώτη γραμμή τα συγκεκριμένα λεκτικά στηλών
και τα data να αρχίζουν από την 2η γραμμή. Να μην υπάρχουν σύνολα στο τέλος ή οτιδήποτε άλλο πέραν της απλής
μορφής ενός πίνακα δεδομένων.
Οι στήλες πρέπει να φέρουν συγκλεκριμένα λεκτικά:
Line, Ref, Hotel, Room, Meal, Checkin, Checkout, Adults, Children
Δεν είναι απαραίτητο να βρίσκονται με αυτήν την σειρά και επιτρέπεται να υπάρχουν άλλες στήλες, οι οποίες
απλώς θα αγνοηθούν



Ascii file Καταχωρημένων κρατήσεων:
------------------------------------
unload to "genero.txt"
select
r.irowid, k.kr_xref, r.rs_htl, r.rs_rc3, r.rs_meal,
--k.kr_tadu, k.kr_tchi, 
r.rs_tpax, 0,
r.rs_dt1, r.rs_dt2
from resrv r, kratf k
where
k.kr_stu = 2 and
k.kr_seas = "SO16" and
k.kr_oper = 6 and
r.rs_krt = k.irowid and
r.rs_stu = 2 and
r.rs_dt1 between "10/8/2016" and "31/10/2016" and
r.rs_typ in ("HTL", "R/R", "CAR") and
r.rs_vte = 1 and
(r.rs_typ != "HTL" or r.rs_rc3 != "000")
order by 2,3,4,1



Τι άλλες πληροφορίες απαιτούνται;
---------------------------------
Το πρόγραμμα ΔΕΝ συνδέεται με ΒΔ. Διαβάζει από συγκεκριμένα .unl files όλα τα ονόματα των ξενοδοχείων
και όλα τα ονόματα των δωματίων, τα οποία προσπαθεί να ανιχνεύσει/αντιστοιχίσει στα input excel data.
Τα αρχεία αυτά είναι ανά Seas/Oper, δηλ. ο χρήστης πρέπει να φροντίσει να τροφοδοτήσει το πρόγραμμα με τις
πληροφορίες που αφορούν καθένα τέτοιο συνδυασμό για τον οποίο θέλει να διαβάσει excel.

Ποια είναι αυτά τα βοηθητικά αρχεία που προσφέρει ο χρήστης;
Τα αρχεία έχουν πρόθεμα που φανερώνει Seas/Oper, και είναι τα εξής τρία:
	SO16.6.hotels.unl				// Στη μορφή:   AKIN|ATHENS KING MINOS|
	SO16.6.rooms.unl				// Στη μορφή:	AAMR|2FA|FAMILY ROOM|
	SO16.6.mappings.unl				// Στη μορφή:	Double Room Sea View S16|2RA|

Το αρχείο mappings (το οποίο μπορεί αρχικά και να μην υπάρχει καθόλου, ενώ στο τέλος εκτέλεσης του προγράμματος ενημερώνεται ξανά)
είναι όλη η βάση με τα επιτυχημένα matching ανάμεσα στα λεκτικά του Cyplon και τους κωδικούς TC που έχουν γίνει so far
και αποτελούν την "περιουσία" του mapping για κατοπινές εκτελέσεις του προγράμματος.
Στο αρχείο mappings συνυπάρχουν γραμμές που αφορούν hotels και γραμμές με ονόματα rooms!



Που βάζουμε τα αρχεία;
------------------------------------
Σε κάποιο folder όλα μαζί, και το folder αυτό το ορίζουμε στις παραμέτρους του προγράμματος.



Εγκατάσταση:
-------------------------------
Απλό copy του .NET exe μαζί με τα 
Syncfusion.Base.dll
Syncfusion.Compression.Base.dll
Syncfusion.XlsIO.Base.dll
αλλά επιπλέπον πιθανότατα θα θέλετε να αντιγράψετε σε επόμενες εγκαταστάσεις τα *.unl αρχεία
Απαιτείται το .NET 4.6.1





